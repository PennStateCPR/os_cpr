var commit=commit||{};(function($){"use strict";commit.validator=function(options){var self={defaults:{selectors:{controls:".controls",controlGroup:".control-group",hidden:"#btnsubmit",helpInline:".help-inline",formPopover:"#formPopover",formPopoverContent:"#formPopoverContent",formModal:"#formModal",formModalYes:"#formModalYes",formModalNo:"#formModalNo",primary:"#continueButton",back:"#backButton"},rules:{},messages:{},formPopover:!1,formModal:!1,focus:!1,verify:!1},options:{},selectors:{},utils:{},dialog:{},rules:{},messages:{},mergeOptions:function(options){if(this.options=$.extend(!0,{},this.defaults,options),_.isEmpty(this.options.selectors))throw Error("Unexpected value. Object cannot be empty.");if(this.options.highlight&&"function"!=typeof this.options.highlight)throw Error("Unexpected value. Expected a function instead of "+typeof this.options.highlight+".");if(this.options.unhighlight&&"function"!=typeof this.options.unhighlight)throw Error("Unexpected value. Expected a function instead of "+typeof this.options.unhighlight+".");if(this.options.submit&&"function"!=typeof this.options.submit)throw Error("Unexpected value. Expected a function instead of "+typeof this.options.submit+".");if(this.options.formPopover&&"boolean"!=typeof this.options.formPopover)throw Error("Unexpected value. Expected a boolean instead of "+typeof this.options.formPopover+".");if(this.options.formModal&&"boolean"!=typeof this.options.formModal)throw Error("Unexpected value. Expected a boolean instead of "+typeof this.options.formModal+".");if(this.options.focus&&"boolean"!=typeof this.options.focus)throw Error("Unexpected value. Expected a boolean instead of "+typeof this.options.focus+".");if(this.options.verify&&"boolean"!=typeof this.options.verify)throw Error("Unexpected value. Expected a boolean instead of "+typeof this.options.verify+".");this.selectors=this.options.selectors,this.rules=this.options.rules,this.messages=this.options.messages},highlight:function(element){$(element).closest(this.selectors.controlGroup).addClass("error")},unhighlight:function(element){$(element).closest(this.selectors.controlGroup).removeClass("error")},validate:function(){var form=$(this.selectors.form),back=form.find(this.selectors.back);commit.utils.setCookie("referrer",form.attr("name")),commit.utils.navHook(back),form.validate({errorElement:"span",errorClass:"help-block",rules:this.rules,messages:this.messages,highlight:_.bind(function(element){this.options.hasOwnProperty("highlight")?this.options.highlight(element):this.highlight(element)},this),unhighlight:_.bind(function(element){this.options.hasOwnProperty("unhighlight")?this.options.unhighlight(element):this.unhighlight(element)},this),errorPlacement:_.bind(function(error,element){var controls=$(element).closest(this.selectors.controls);controls.append(error)},this),submitHandler:_.bind(function(form){var hidden,submission;hidden=$(form).find(this.selectors.hidden),hidden.attr("value","."),this.options.formModal?this.dialog.modal("show"):(commit.navHook=!0,submission=this.options.submit?this.options.submit(form):form.submit())},this)})},initializeFormModal:function(){var form,primary,submission;this.options.formModal&&(this.dialog=$(this.selectors.formModal),this.dialog.modal({show:!1}),form=$(this.selectors.form),primary=this.dialog.find(this.selectors.formModalYes),primary.on("click",_.bind(function(e){e.preventDefault(),commit.navHook=!0,submission=this.options.submit?this.options.submit(form[0]):form[0].submit()},this)))},initializeFormPopover:function(){if(this.options.formPopover){var formPopover,formPopoverContent;formPopover=$(this.selectors.formPopover),formPopoverContent=$(this.selectors.formPopoverContent).html(),this.utils.popover(formPopover,formPopoverContent,{placement:"bottom"})}},forceFocus:function(){if(this.options.focus){var form=$(this.selectors.form),inputs=form.find(":input");inputs[0]&&inputs[0].focus()}},verify:function(){if(this.options.verify){var form=$(this.selectors.form),primary=form.find(this.selectors.primary),back=form.find(this.selectors.back),condition="true"===commit.utils.getCookie("verification")?!0:!1;condition&&(primary.html("Verify"),back.hide())}},initialize:function(options){_.bindAll(this),this.utils=commit.utils,this.mergeOptions(options),this.initializeFormPopover(),this.initializeFormModal(),this.validate(),this.forceFocus(),this.verify()}};return self.initialize(options),self}})(jQuery);